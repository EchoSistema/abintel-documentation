# 4.3.3 /api/v1/ai/forecast_cost
+> Nota: traducción generada automáticamente desde el inglés; revisar antes de publicar.


### One-shot daily cost projection

**Purpose** Forecast the total daily COGS/OPEX (or any cost series) out six months.  
The service auto-benchmarks classic time-series models against tree-based ML, picks the champion, and returns both calendar-day and business-day aggregates.

---

### Headers `X-Customer-Api-Id`, `X-Secret`

```yml
POST `https://api.abintel.ai/api/v1/ai/forecast_cost`
headers:
X-Customer-Api-Id: <uuid>
X-Secret: <secret>
Content-Type: application/json
```

---


---

### Why you’d call it

| Business question                          | How the route helps                                                                        | Typical payoff                                      |
|------------------------------------------  |------------------------------------------------------------------------                    |-----------------------------------------------------|
| “How much cash will we burn next quarter?” | 6-month cost forecast with statistical diagnostics.                                        | Informs cash-flow planning, treasury hedging.       |
| “Which model should finance trust?”        | Cross-validates ARIMA / ETS / Prophet / TBATS / tree ML and returns the lowest-error pick. | Eliminates manual model selection.                  |
| “Need weekends vs workdays split.”         | Returns calendar and business series side-by-side.                                         | Feeds both GL accruals and FP&A staffing models.    |

---

### Request body – field dictionary

| Path            | Type        | Req? | Meaning                          | Notes                                               |
|---------------  |-------------|----- |--------------------------------- |-----------------------------------------------------|
| forecast_period | int ≥ 1     | ✔︎    | Number of months to predict      | 3, 6, 12 common                                     |
| data[]          | array       | ✔︎    | Historic daily cost              | ≥ 45 rows recommended                               |
| ↳ date          | YYYY-MM-DD  | ✔︎    | ISO date                         | Gaps auto-filled with 0                             |
| ↳ cost          | number      | ✔︎    | Cost on that date (same currency)| Negative values allowed (rebates)                   |


---

```json
{
  "forecast_period": 6,
  "data": [
    { "date": "2025-01-01", "cost": 1100.00 },
    { "date": "2025-01-02", "cost": 1112.00 },
    { "date": "2025-01-03", "cost": 1118.00 },
    { "date": "2025-01-04", "cost": 1083.00 },
    { "date": "2025-01-05", "cost": 1078.00 },
    { "date": "2025-01-06", "cost": 1125.00 },
    { "date": "2025-01-07", "cost": 1130.00 },
    { "date": "2025-01-08", "cost": 1136.00 },
    { "date": "2025-01-09", "cost": 1142.00 },
    { "date": "2025-01-10", "cost": 1148.00 },
    { "date": "2025-01-11", "cost": 1105.00 },
    { "date": "2025-01-12", "cost": 1098.00 },
    { "date": "2025-01-13", "cost": 1156.00 },
    { "date": "2025-01-14", "cost": 1162.00 },
    { "date": "2025-01-15", "cost": 1168.00 },
    { "date": "2025-01-16", "cost": 1174.00 },
    { "date": "2025-01-17", "cost": 1180.00 },
    { "date": "2025-01-18", "cost": 1129.00 },
    { "date": "2025-01-19", "cost": 1122.00 },
    { "date": "2025-01-20", "cost": 1195.00 },
    { "date": "2025-01-21", "cost": 1202.00 },
    { "date": "2025-01-22", "cost": 1208.00 },
    { "date": "2025-01-23", "cost": 1215.00 },
    { "date": "2025-01-24", "cost": 1221.00 },
    { "date": "2025-01-25", "cost": 1166.00 },
    { "date": "2025-01-26", "cost": 1158.00 },
    { "date": "2025-01-27", "cost": 1229.00 },
    { "date": "2025-01-28", "cost": 1236.00 },
    { "date": "2025-01-29", "cost": 1242.00 },
    { "date": "2025-01-30", "cost": 1249.00 },
    { "date": "2025-01-31", "cost": 1255.00 },

    { "date": "2025-02-01", "cost": 1205.00 },
    { "date": "2025-02-02", "cost": 1198.00 },
    { "date": "2025-02-03", "cost": 1262.00 },
    { "date": "2025-02-04", "cost": 1268.00 },
    { "date": "2025-02-05", "cost": 1275.00 },
    { "date": "2025-02-06", "cost": 1281.00 },
    { "date": "2025-02-07", "cost": 1287.00 },
    { "date": "2025-02-08", "cost": 1234.00 },
    { "date": "2025-02-09", "cost": 1226.00 },
    { "date": "2025-02-10", "cost": 1293.00 },
    { "date": "2025-02-11", "cost": 1299.00 },
    { "date": "2025-02-12", "cost": 1306.00 },
    { "date": "2025-02-13", "cost": 1312.00 },
    { "date": "2025-02-14", "cost": 1318.00 },
    { "date": "2025-02-15", "cost": 1263.00 },
    { "date": "2025-02-16", "cost": 1255.00 },
    { "date": "2025-02-17", "cost": 1326.00 },
    { "date": "2025-02-18", "cost": 1333.00 },
    { "date": "2025-02-19", "cost": 1339.00 },
    { "date": "2025-02-20", "cost": 1346.00 },
    { "date": "2025-02-21", "cost": 1352.00 },
    { "date": "2025-02-22", "cost": 1296.00 },
    { "date": "2025-02-23", "cost": 1288.00 },
    { "date": "2025-02-24", "cost": 1359.00 },
    { "date": "2025-02-25", "cost": 1366.00 },
    { "date": "2025-02-26", "cost": 1372.00 },
    { "date": "2025-02-27", "cost": 1379.00 },
    { "date": "2025-02-28", "cost": 1385.00 },

    { "date": "2025-03-01", "cost": 1332.00 },
    { "date": "2025-03-02", "cost": 1324.00 },
    { "date": "2025-03-03", "cost": 1392.00 },
    { "date": "2025-03-04", "cost": 1399.00 },
    { "date": "2025-03-05", "cost": 1405.00 },
    { "date": "2025-03-06", "cost": 1412.00 },
    { "date": "2025-03-07", "cost": 1418.00 },
    { "date": "2025-03-08", "cost": 1362.00 },
    { "date": "2025-03-09", "cost": 1355.00 },
    { "date": "2025-03-10", "cost": 1424.00 },
    { "date": "2025-03-11", "cost": 1431.00 },
    { "date": "2025-03-12", "cost": 1437.00 },
    { "date": "2025-03-13", "cost": 1444.00 },
    { "date": "2025-03-14", "cost": 1450.00 },
    { "date": "2025-03-15", "cost": 1393.00 },
    { "date": "2025-03-16", "cost": 1385.00 },
    { "date": "2025-03-17", "cost": 1456.00 },
    { "date": "2025-03-18", "cost": 1463.00 },
    { "date": "2025-03-19", "cost": 1469.00 },
    { "date": "2025-03-20", "cost": 1476.00 },
    { "date": "2025-03-21", "cost": 1482.00 },
    { "date": "2025-03-22", "cost": 1424.00 },
    { "date": "2025-03-23", "cost": 1416.00 },
    { "date": "2025-03-24", "cost": 1488.00 },
    { "date": "2025-03-25", "cost": 1495.00 },
    { "date": "2025-03-26", "cost": 1501.00 },
    { "date": "2025-03-27", "cost": 1508.00 },
    { "date": "2025-03-28", "cost": 1514.00 },
    { "date": "2025-03-29", "cost": 1456.00 },
    { "date": "2025-03-30", "cost": 1448.00 }
  ]
}
```

---

## How it works under the hood

- **Pre-processing** — sort, fill missing dates, Hampel filter outliers (flagged).  
- **Feature engineering** — lag 7/14/28, month & weekday dummies, moving averages.  
- **Model zoo** — Seasonal-ARIMA, ETS, STL-TBATS, Prophet, Random-Forest, Gradient-Boost.  
- **Validation** — expanding-window CV → RMSE/MAE/R².  
- **Champion selection** — lowest RMSE (tie-break: lower MAE).  
- **Forecast horizon** — forecast_period × 30 calendar days, then roll-up to month-level calendar & biz-day.  
- **Post-process** — negatives are clipped to 0; adds two-sigma error band (not shown here).  
- **Return** — JSON + run-time.

---

## Reference response explained

```json
{
  "forecast_period": 6,
  "forecast_result": {
    "analysis_type": "generic_cost",
    "best_algorithm": "Aggregation",
    "evaluation_metrics": {
      "RMSE": 31.871275523384387,
      "MAE": 26.72328927342509,
      "R2": 0.225582055790993,
      "average_daily_cost": 1466.3052433749297,
      "Interpretation": "The Aggregation algorithm was selected because it achieved a low RMSE of 31.87, MAE of 26.72, and R² of 0.23. The average daily cost forecast is 1466.31."
    },
    "forecast": {
      "calendar": [
        { "yyyy-mm": "2025-04", "value": 45003.125869601354 },
        { "yyyy-mm": "2025-05", "value": 46503.23006525473 },
        { "yyyy-mm": "2025-06", "value": 45003.125869601354 },
        { "yyyy-mm": "2025-07", "value": 46503.23006525473 },
        { "yyyy-mm": "2025-08", "value": 46503.23006525473 },
        { "yyyy-mm": "2025-09", "value": 45003.125869601354 }
      ],
      "business": [
        { "yyyy-mm": "2025-04", "value": 33002.29230437432 },
        { "yyyy-mm": "2025-05", "value": 33002.29230437432 },
        { "yyyy-mm": "2025-06", "value": 31502.188108720948 },
        { "yyyy-mm": "2025-07", "value": 34502.3965000277 },
        { "yyyy-mm": "2025-08", "value": 31502.188108720948 },
        { "yyyy-mm": "2025-09", "value": 33002.29230437432 }
      ]
    }
  },
  "execution_time_seconds": 0.2536935806274414
}
```

---

## Field

| Field                | How to read                                     | Suggested action                                                     |
| -------------------- | ----------------------------------------------- | -------------------------------------------------------------------- |
| best_algorithm       | Winner of the bake-off.                         | Track per series; sudden switch to ML may indicate structural break. |
| average_daily_cost   | Mean of the historic series.                    | Quick sense-check vs budget.                                         |
| calendar             | 100 % of days, weekends included.               | Use for cash-flow burn rate.                                         |
| business             | Mon-Fri (holidays removed via region calendar). | Feed to workforce & AP accrual planning.                             |

---

## Tips & caveats

* Commodity price shocks — Pass an extra column `commodity_index` (numeric) — tree models will pick it up.

* Public holidays — Send `"holiday":"NYD"` etc.; Prophet & trees exploit it.

* Variance bounds — Add `"return_prediction_interval": true` to get 80 % / 95 % bands.

* Very new cost centre (< 30 pts) — Service falls back to naïve mean and sets `"note":"cold-start"`.

---

## Próximo Paso
Automate this call on the last calendar day each month; push the business forecast into your rolling 13-week cash-flow model, and trigger re-forecast if actuals stray > 15 % outside the 80 % PI for two consecutive weeks.

---

