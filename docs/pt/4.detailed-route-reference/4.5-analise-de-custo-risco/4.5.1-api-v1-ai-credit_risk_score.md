# 4.5.1 /api/v1/ai/credit_risk_score
+> Nota: tradução gerada automaticamente a partir do inglês; revise antes de publicar.


**Train-and-score a Probability-of-Default (PD) model in one call**

### Objetivo
Post a mixed batch of labelled & un-labelled applicants and receive model quality, per-applicant PDs and explainable SHAP drivers.

---

### Headers `X-Customer-Api-Id`, `X-Secret`

```yml
POST https://api.abintel.ai/api/v1/ai/credit_risk_score
headers:
X-Customer-Api-Id: <uuid>
X-Secret: <secret>
Content-Type: application/json
```


---

## Why this route matters

| **Pain-point for risk teams**                               | **What the endpoint returns**                                                                              |
|-------------------------------------------------------------|----------------------------------------------------------------------------------------------------------- |
| Need to prototype a scorecard fast without MLOps plumbing   | Automatic model bake-off (LogReg, RF, XGBoost, CatBoost) and AUC on a hold-out split.                      |
| Want explainability for regulators                          | SHAP top-feature list per applicant + human-readable interpretation string.                                |
| Chaos of many CSVs / feature sets                           | Accepts any mix of numeric & categorical fields inside `features{}` — one-hot encoding is handled for you. |
| Must score new applicants daily                             | Same JSON schema works with `label` omitted, endpoint just scores with the latest champion model.          |

---

## Request payload reference

| **Path**             | **Type** | **Required** | **Notes**                                                                 |
|----------------------|----------|--------------|---------------------------------------------------------------------------|
| `test_size`          | float    | ✱            | Share of rows reserved for validation (0 < value < 1).                    |
| `applicants[]`       | array    | ✔︎           | One object per borrower.                                                 |
| ↳ `id`              | string   | ✔︎           | Unique key copied to the response.                                       |
| ↳ `features`        | object   | ✔︎           | Arbitrary key/values. Numeric → used as is; Categorical → one-hot encoded. |
| ↳ `label`           | 0/1      | Training only| 1 = default/charge-off, 0 = good credit. Omit for pure scoring calls.     |

> ✱ If you skip `test_size`, default 0.2 is applied.

---

### Requisição

```json
{
  "test_size": 0.2,
  "applicants": [
    { "id": "app-001", "features": { "income": 55000, "age": 34, "country": "BR", "late_payments": 0 }, "label": 0 },
    ...
    { "id": "app-050", "features": { "income": 63000, "age": 23, "country": "UK", "late_payments": 0 }, "label": 1 }
  ]
}
```

---

### The route:

1. One-hot encodes categoricals.

2. Model bake-off (LogReg, RF, XGBoost, CatBoost) on the hold-out split.

3. Retrains the best model on ALL data and scores every applicant.

4. Returns:
    • **auc** – overall AUC on hold-out set
    • **best_model** – algorithm selected
    • **predictions[]** – per-applicant PD + SHAP top-features (if available)
    • **interpretation** – English summary

### Pure scoring example

Send the same object without **label** to get PDs using your last trained model.

---

### Resposta

```json
{
    "auc": 1.0,
    "best_model": "LogisticRegression",
    "predictions": [
        {
            "id": "app-001",
            "probability": 0.0001,
            "shap_values": {
                "num__age": 2.214572098503316,
                "num__late_payments": -1.384564942339434,
                "num__income": -0.893762081144131,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age +2.2 ↑ risk; late payments -1.4 ↓ risk; income -0.9 ↓ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-002",
            "probability": 0.317,
            "shap_values": {
                "num__age": 7.589747094870583,
                "num__income": 0.5174412048729179,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253,
                "num__late_payments": -0.1258695402126759
            },
            "shap_interpretation": "PD 31.7 % ⇒ MEDIUM risk.  age +7.6 ↑ risk; income +0.5 ↑ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk; late payments -0.1 ↓ risk"
        },
        {
            "id": "app-003",
            "probability": 0.0,
            "shap_values": {
                "num__age": -10.685847892778124,
                "num__income": 1.7718441257769615,
                "num__late_payments": -1.384564942339434,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -10.7 ↓ risk; income +1.8 ↑ risk; late payments -1.4 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-004",
            "probability": 0.0006,
            "shap_values": {
                "num__age": 5.439677096323677,
                "num__income": -2.1481650020481746,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.1 % ⇒ LOW risk.  age +5.4 ↑ risk; income -2.1 ↓ risk; late payments -1.4 ↓ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-005",
            "probability": 0.0,
            "shap_values": {
                "num__age": -5.310672896410857,
                "num__income": 3.4966481420200215,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": 0.12908922691106253,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -5.3 ↓ risk; income +3.5 ↑ risk; late payments -1.4 ↓ risk; country BR +0.1 ↑ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-006",
            "probability": 0.0361,
            "shap_values": {
                "num__age": 9.73981709341749,
                "num__income": -3.5593682880652233,
                "cat__country_BR": -0.178266075258134,
                "num__late_payments": -0.1258695402126759,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 3.6 % ⇒ LOW risk.  age +9.7 ↑ risk; income -3.6 ↓ risk; country BR -0.2 ↓ risk; late payments -0.1 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-007",
            "probability": 0.0,
            "shap_values": {
                "num__age": -17.136057888418843,
                "num__income": 4.7510510629240645,
                "num__late_payments": -1.384564942339434,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -17.1 ↓ risk; income +4.8 ↑ risk; late payments -1.4 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-008",
            "probability": 0.0001,
            "shap_values": {
                "num__age": 3.2896070977767695,
                "num__income": -2.30496536716118,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age +3.3 ↑ risk; income -2.3 ↓ risk; late payments -1.4 ↓ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-009",
            "probability": 0.0,
            "shap_values": {
                "num__age": -3.1606028978639507,
                "num__income": 1.928644490889967,
                "num__late_payments": -1.384564942339434,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -3.2 ↓ risk; income +1.9 ↑ risk; late payments -1.4 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-010",
            "probability": 0.0,
            "shap_values": {
                "num__age": -9.61081289350467,
                "num__income": 3.18304741179401,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": 0.12908922691106253,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -9.6 ↓ risk; income +3.2 ↑ risk; late payments -1.4 ↓ risk; country BR +0.1 ↑ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-011",
            "probability": 0.177,
            "shap_values": {
                "num__age": 8.664782094144037,
                "num__income": -0.7369617160311256,
                "cat__country_BR": -0.178266075258134,
                "num__late_payments": -0.1258695402126759,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 17.7 % ⇒ LOW risk.  age +8.7 ↑ risk; income -0.7 ↓ risk; country BR -0.2 ↓ risk; late payments -0.1 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-012",
            "probability": 0.0,
            "shap_values": {
                "num__late_payments": -1.384564942339434,
                "num__age": -1.0105328993170437,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253,
                "num__income": -0.10976025557910381
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  late payments -1.4 ↓ risk; age -1.0 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk; income -0.1 ↓ risk"
        },
        {
            "id": "app-013",
            "probability": 0.0,
            "shap_values": {
                "num__age": -6.385707895684311,
                "num__income": 1.3014430304379452,
                "num__late_payments": 1.132825861914082,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -6.4 ↓ risk; income +1.3 ↑ risk; late payments +1.1 ↑ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-014",
            "probability": 0.0038,
            "shap_values": {
                "num__age": 6.51471209559713,
                "num__late_payments": -1.384564942339434,
                "num__income": -1.3641631764831472,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.4 % ⇒ LOW risk.  age +6.5 ↑ risk; late payments -1.4 ↓ risk; income -1.4 ↓ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-015",
            "probability": 0.0,
            "shap_values": {
                "num__age": -14.985987889871938,
                "num__income": 4.123849602472043,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": 0.12908922691106253,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -15.0 ↓ risk; income +4.1 ↑ risk; late payments -1.4 ↓ risk; country BR +0.1 ↑ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-016",
            "probability": 0.2195,
            "shap_values": {
                "num__age": 10.814852092690943,
                "num__income": -2.6185660973871907,
                "cat__country_BR": -0.178266075258134,
                "num__late_payments": -0.1258695402126759,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 21.9 % ⇒ LOW risk.  age +10.8 ↑ risk; income -2.6 ↓ risk; country BR -0.2 ↓ risk; late payments -0.1 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-017",
            "probability": 0.0,
            "shap_values": {
                "num__age": -18.2110928876923,
                "num__income": 5.064651793150076,
                "num__late_payments": -1.384564942339434,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -18.2 ↓ risk; income +5.1 ↑ risk; late payments -1.4 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-018",
            "probability": 0.0,
            "shap_values": {
                "num__income": -1.991364636935169,
                "num__late_payments": -1.384564942339434,
                "num__age": 1.139537099229863,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  income -2.0 ↓ risk; late payments -1.4 ↓ risk; age +1.1 ↑ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-019",
            "probability": 0.0,
            "shap_values": {
                "num__age": -4.235637897137404,
                "num__income": 2.3990455862289832,
                "num__late_payments": -1.384564942339434,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -4.2 ↓ risk; income +2.4 ↑ risk; late payments -1.4 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-020",
            "probability": 0.0,
            "shap_values": {
                "num__age": -8.535777894231217,
                "num__income": 3.339847776907016,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": 0.12908922691106253,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -8.5 ↓ risk; income +3.3 ↑ risk; late payments -1.4 ↓ risk; country BR +0.1 ↑ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-021",
            "probability": 0.0034,
            "shap_values": {
                "num__age": 4.364642097050223,
                "num__income": -0.5801613509181202,
                "cat__country_BR": -0.178266075258134,
                "num__late_payments": -0.1258695402126759,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.3 % ⇒ LOW risk.  age +4.4 ↑ risk; income -0.6 ↓ risk; country BR -0.2 ↓ risk; late payments -0.1 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-022",
            "probability": 0.0,
            "shap_values": {
                "num__age": -2.0855678985904973,
                "num__late_payments": -1.384564942339434,
                "num__income": 0.3606408397599125,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -2.1 ↓ risk; late payments -1.4 ↓ risk; income +0.4 ↑ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-023",
            "probability": 0.0,
            "shap_values": {
                "num__age": -7.460742894957764,
                "num__income": 1.4582433955509506,
                "num__late_payments": -1.384564942339434,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -7.5 ↓ risk; income +1.5 ↑ risk; late payments -1.4 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-024",
            "probability": 0.0324,
            "shap_values": {
                "num__age": 7.589747094870583,
                "num__income": -1.5209635415961527,
                "cat__country_BR": -0.178266075258134,
                "num__late_payments": -0.1258695402126759,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 3.2 % ⇒ LOW risk.  age +7.6 ↑ risk; income -1.5 ↓ risk; country BR -0.2 ↓ risk; late payments -0.1 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-025",
            "probability": 0.0,
            "shap_values": {
                "num__age": -13.910952890598484,
                "num__income": 4.280649967585049,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": 0.12908922691106253,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -13.9 ↓ risk; income +4.3 ↑ risk; late payments -1.4 ↓ risk; country BR +0.1 ↑ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-026",
            "probability": 0.1337,
            "shap_values": {
                "num__age": 9.73981709341749,
                "num__income": -3.402567922952218,
                "num__late_payments": 1.132825861914082,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 13.4 % ⇒ LOW risk.  age +9.7 ↑ risk; income -3.4 ↓ risk; late payments +1.1 ↑ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-027",
            "probability": 0.0,
            "shap_values": {
                "num__age": -21.43619788551266,
                "num__income": 5.378252523376086,
                "num__late_payments": -1.384564942339434,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -21.4 ↓ risk; income +5.4 ↑ risk; late payments -1.4 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-028",
            "probability": 0.0001,
            "shap_values": {
                "num__age": 2.214572098503316,
                "num__income": -2.1481650020481746,
                "cat__country_BR": -0.178266075258134,
                "num__late_payments": -0.1258695402126759,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age +2.2 ↑ risk; income -2.1 ↓ risk; country BR -0.2 ↓ risk; late payments -0.1 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-029",
            "probability": 0.0,
            "shap_values": {
                "num__age": -5.310672896410857,
                "num__income": 2.2422452211159776,
                "num__late_payments": -1.384564942339434,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -5.3 ↓ risk; income +2.2 ↑ risk; late payments -1.4 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-030",
            "probability": 0.0,
            "shap_values": {
                "num__age": -10.685847892778124,
                "num__income": 3.4966481420200215,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": 0.12908922691106253,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -10.7 ↓ risk; income +3.5 ↑ risk; late payments -1.4 ↓ risk; country BR +0.1 ↑ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-031",
            "probability": 0.0005,
            "shap_values": {
                "num__age": 3.2896070977767695,
                "num__late_payments": -1.384564942339434,
                "num__income": -0.26656062069210923,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age +3.3 ↑ risk; late payments -1.4 ↓ risk; income -0.3 ↓ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-032",
            "probability": 0.0001,
            "shap_values": {
                "num__age": -1.0105328993170437,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253,
                "num__late_payments": -0.1258695402126759,
                "num__income": 0.047040109533901635
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -1.0 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk; late payments -0.1 ↓ risk; income +0.0 ↑ risk"
        },
        {
            "id": "app-033",
            "probability": 0.0,
            "shap_values": {
                "num__age": -6.385707895684311,
                "num__late_payments": -1.384564942339434,
                "num__income": 0.9878423002119343,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -6.4 ↓ risk; late payments -1.4 ↓ risk; income +1.0 ↑ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-034",
            "probability": 0.0044,
            "shap_values": {
                "num__age": 6.51471209559713,
                "num__late_payments": -1.384564942339434,
                "num__income": -1.2073628113701418,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.4 % ⇒ LOW risk.  age +6.5 ↑ risk; late payments -1.4 ↓ risk; income -1.2 ↓ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-035",
            "probability": 0.0,
            "shap_values": {
                "num__age": -16.06102288914539,
                "num__income": 4.594250697811059,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": 0.12908922691106253,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -16.1 ↓ risk; income +4.6 ↑ risk; late payments -1.4 ↓ risk; country BR +0.1 ↑ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-036",
            "probability": 0.0201,
            "shap_values": {
                "num__age": 8.664782094144037,
                "num__income": -3.0889671927262072,
                "cat__country_BR": -0.178266075258134,
                "num__late_payments": -0.1258695402126759,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 2.0 % ⇒ LOW risk.  age +8.7 ↑ risk; income -3.1 ↓ risk; country BR -0.2 ↓ risk; late payments -0.1 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-037",
            "probability": 0.0,
            "shap_values": {
                "num__age": -20.361162886239203,
                "num__income": 5.691853253602098,
                "num__late_payments": -1.384564942339434,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -20.4 ↓ risk; income +5.7 ↑ risk; late payments -1.4 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-038",
            "probability": 0.0,
            "shap_values": {
                "num__income": -1.8345642718221635,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173,
                "num__age": 0.06450209995640964
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  income -1.8 ↓ risk; late payments -1.4 ↓ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk; age +0.1 ↑ risk"
        },
        {
            "id": "app-039",
            "probability": 0.0,
            "shap_values": {
                "num__age": -4.235637897137404,
                "num__income": 2.712646316454994,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253,
                "num__late_payments": -0.1258695402126759
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -4.2 ↓ risk; income +2.7 ↑ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk; late payments -0.1 ↓ risk"
        },
        {
            "id": "app-040",
            "probability": 0.0,
            "shap_values": {
                "num__age": -11.760882892051578,
                "num__income": 3.6534485071330267,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": 0.12908922691106253,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 0.0 % ⇒ LOW risk.  age -11.8 ↓ risk; income +3.7 ↑ risk; late payments -1.4 ↓ risk; country BR +0.1 ↑ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-041",
            "probability": 0.9388,
            "shap_values": {
                "num__age": 15.114992089784757,
                "num__income": -6.695375590325332,
                "num__late_payments": 3.6502166661675983,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 93.9 % ⇒ HIGH risk.  age +15.1 ↑ risk; income -6.7 ↓ risk; late payments +3.7 ↑ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-042",
            "probability": 0.9237,
            "shap_values": {
                "num__age": 11.889887091964397,
                "num__income": -6.2249744949863155,
                "num__late_payments": 6.167607470421115,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 92.4 % ⇒ HIGH risk.  age +11.9 ↑ risk; income -6.2 ↓ risk; late payments +6.2 ↑ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-043",
            "probability": 0.7721,
            "shap_values": {
                "num__age": 10.814852092690943,
                "num__income": -5.7545733996473,
                "num__late_payments": 4.908912068294356,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 77.2 % ⇒ HIGH risk.  age +10.8 ↑ risk; income -5.8 ↓ risk; late payments +4.9 ↑ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-044",
            "probability": 0.998,
            "shap_values": {
                "num__age": 14.039957090511303,
                "num__late_payments": 7.426302872547873,
                "num__income": -5.911373764760305,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 99.8 % ⇒ HIGH risk.  age +14.0 ↑ risk; late payments +7.4 ↑ risk; income -5.9 ↓ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-045",
            "probability": 0.998,
            "shap_values": {
                "num__age": 12.96492209123785,
                "num__late_payments": 8.68499827467463,
                "num__income": -6.381774860099322,
                "cat__country_BR": 0.12908922691106253,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 99.8 % ⇒ HIGH risk.  age +13.0 ↑ risk; late payments +8.7 ↑ risk; income -6.4 ↓ risk; country BR +0.1 ↑ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-046",
            "probability": 0.941,
            "shap_values": {
                "num__age": 11.889887091964397,
                "num__income": -6.538575225212327,
                "num__late_payments": 6.167607470421115,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 94.1 % ⇒ HIGH risk.  age +11.9 ↑ risk; income -6.5 ↓ risk; late payments +6.2 ↑ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-047",
            "probability": 0.9788,
            "shap_values": {
                "num__age": 15.114992089784757,
                "num__income": -6.852175955438337,
                "num__late_payments": 4.908912068294356,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 97.9 % ⇒ HIGH risk.  age +15.1 ↑ risk; income -6.9 ↓ risk; late payments +4.9 ↑ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-048",
            "probability": 0.6843,
            "shap_values": {
                "num__age": 8.664782094144037,
                "num__income": 2.2422452211159776,
                "num__late_payments": -1.384564942339434,
                "cat__country_US": 0.1753505606242486,
                "cat__country_BR": 0.12908922691106253
            },
            "shap_interpretation": "PD 68.4 % ⇒ MEDIUM risk.  age +8.7 ↑ risk; income +2.2 ↑ risk; late payments -1.4 ↓ risk; country US +0.2 ↑ risk; country BR +0.1 ↑ risk"
        },
        {
            "id": "app-049",
            "probability": 0.8344,
            "shap_values": {
                "num__age": 7.589747094870583,
                "num__income": 4.7510510629240645,
                "num__late_payments": -1.384564942339434,
                "cat__country_BR": -0.178266075258134,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 83.4 % ⇒ HIGH risk.  age +7.6 ↑ risk; income +4.8 ↑ risk; late payments -1.4 ↓ risk; country BR -0.2 ↓ risk; country US -0.1 ↓ risk"
        },
        {
            "id": "app-050",
            "probability": 0.982,
            "shap_values": {
                "num__age": 14.039957090511303,
                "num__late_payments": -1.384564942339434,
                "num__income": 0.3606408397599125,
                "cat__country_BR": 0.12908922691106253,
                "cat__country_US": -0.10747292425357173
            },
            "shap_interpretation": "PD 98.2 % ⇒ HIGH risk.  age +14.0 ↑ risk; late payments -1.4 ↓ risk; income +0.4 ↑ risk; country BR +0.1 ↑ risk; country US -0.1 ↓ risk"
        }
    ],
    "interpretation": "AUC=1.0000 with LogisticRegression. Portfolio split: 9 HIGH / 2 MED / 39 LOW."
}
```

---

### Risk buckets in the interpretation

Risk buckets follow default cut-offs:  
- **Low** < 0.25  
- **Medium** < 0.6  
- **High** ≥ 0.6  

 Adjust with a query param: `thresholds=0.2,0.5` if needed.

---

## What happens under the hood

- **Encoding** – numeric features scaled, categoricals one-hot.  
- **Model bake-off** – trains Logistic Regression, Random Forest, XGBoost & CatBoost on the training slice, selects highest AUC.  
- **Retrain** – winning model fit on the full dataset.  
- **Scoring + SHAP** – PD for every row; top-5 absolute SHAP contributors extracted.

---

## Fluxo de Trabalho Típico

- Batch-train once a day with fresh repayment labels.  
- Store the `best_model` snapshot ID you receive (for audit).  
- Score live applicants during the day by omitting label.  
- Feed PDs into pricing / limit-assignment logic; archive SHAP explanations for compliance.  
- Monitor `auc` drift over time → retrain when it drops below your KPI.

---

