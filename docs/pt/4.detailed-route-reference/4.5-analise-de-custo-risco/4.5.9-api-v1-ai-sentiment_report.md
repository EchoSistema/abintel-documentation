# 4.5.9 /api/v1/ai/sentiment_report
+> Nota: tradu√ß√£o gerada automaticamente a partir do ingl√™s; revise antes de publicar.


### Turn raw verbatims into a compact Voice-of-Customer dashboard

### Purpose‚ÄÉPipe in any free-text feedback (reviews, tickets, tweets, chat logs‚Ä¶) and the route classifies each item, rolls up weekly/daily KPIs, and highlights trending topics that deserve action.

---

### Headers `X-Customer-Api-Id`, `X-Secret`


```yaml
POST https://api.abintel.ai/api/v1/ai/sentiment_report
X-Customer-Api-Id: <uuid>  
X-Secret: <secret>  
Content-Type: application/json
```

---

### What problem does this solve?

| **You want to know**                    | **Where to look**                                              |
| --------------------------------------- | -------------------------------------------------------------- |
| ‚ÄúHow happy are users this week?‚Äù        | `kpis.positive_pct / negative_pct`                             |
| ‚ÄúWhat keeps breaking?‚Äù                  | `kpis.top_topics[]` and `details[].key_topics`                 |
| ‚ÄúWhich verbatims drive the score down?‚Äù | Filter `details[]` by `sentiment = negative` and sort by score |

---

### Request payload schema

| **Path**    | **Type**            | **Req?** | **Description**                                                |
| ----------- | ------------------- | -------- | -------------------------------------------------------------- |
| timeframe   | "daily" or "weekly" | ‚úîÔ∏é       | How the backend will group entries and calculate period dates. |
| entries[]   | array<object>       | ‚úîÔ∏é (‚â• 5) | Each verbatim to analyse.                                      |
| ‚Ü≥ id        | string              | ‚úîÔ∏é       | Your unique identifier (ticket ID, tweet ID‚Ä¶).                 |
| ‚Ü≥ timestamp | ISO-8601 date       | ‚úîÔ∏é       | When the feedback was created.                                 |
| ‚Ü≥ text      | string              | ‚úîÔ∏é       | Raw message text (emojis & punctuation fine).                  |

Minimum size ‚Äì at least 5 entries; bigger batches produce stabler percentages and topic extraction.

---

### Request Example

```json
{
  "timeframe": "weekly",
  "entries": [
    { "id": "rev-001", "timestamp": "2025-04-21", "text": "Checkout keeps crashing üò°" },
    { "id": "ticket-042", "timestamp": "2025-04-22", "text": "Great support, thank you!" },
    { "id": "tweet-088", "timestamp": "2025-04-23", "text": "New update rocks but battery drains fast." },
    { "id": "chat-105",  "timestamp": "2025-04-23", "text": "Please add PayPal option." },
    { "id": "fb-109",    "timestamp": "2025-04-24", "text": "App still freezes on login." }
  ]
}
```

---

### Response Example

```json
{
  "period_start": "2025-05-21",
  "period_end": "2025-05-21",
  "kpis": {
    "positive_pct": 20.0,
    "neutral_pct": 40.0,
    "negative_pct": 40.0,
    "top_topics": [
      "checkout",
      "crashing",
      "technical issues",
      "support",
      "customer service"
    ]
  },
  "details": [
    {
      "id": "rev-001",
      "sentiment": "negative",
      "emotion": "frustration",
      "score": -0.8,
      "key_topics": [
        "checkout",
        "crashing",
        "technical issues"
      ],
      "interpretation": "Score -0.80 ‚Üí NEGATIVE (‚àí1‚Ä¶+1). Topics: checkout, crashing, technical issues"
    },
    {
      "id": "ticket-042",
      "sentiment": "positive",
      "emotion": "gratitude",
      "score": 0.9,
      "key_topics": [
        "support",
        "customer service"
      ],
      "interpretation": "Score +0.90 ‚Üí POSITIVE (‚àí1‚Ä¶+1). Topics: support, customer service"
    },
    {
      "id": "tweet-088",
      "sentiment": "mixed",
      "emotion": "frustration",
      "score": 0.2,
      "key_topics": [
        "update",
        "battery life",
        "performance"
      ],
      "interpretation": "Score +0.20 ‚Üí MIXED (‚àí1‚Ä¶+1). Topics: update, battery life, performance"
    },
    {
      "id": "chat-105",
      "sentiment": "neutral",
      "emotion": "request",
      "score": 0.0,
      "key_topics": [
        "PayPal",
        "payment options",
        "customer request"
      ],
      "interpretation": "Score +0.00 ‚Üí NEUTRAL (‚àí1‚Ä¶+1). Topics: PayPal, payment options, customer request"
    },
    {
      "id": "fb-109",
      "sentiment": "negative",
      "emotion": "frustration",
      "score": -0.7,
      "key_topics": [
        "app performance",
        "login issues",
        "freezing"
      ],
      "interpretation": "Score -0.70 ‚Üí NEGATIVE (‚àí1‚Ä¶+1). Topics: app performance, login issues, freezing"
    }
  ],
  "interpretation": "20.0% positive vs 40.0% negative this daily. Top pain-points: checkout, crashing, technical issues."
}
```

---

### Field cheat-sheet

| **Field**                   | **Meaning**                                                           |
| --------------------------- | --------------------------------------------------------------------- |
| period_start / period_end   | Bounding dates computed from `entries[].timestamp` and `timeframe`.   |
| kpis.*_pct                  | Share of entries in each sentiment bucket (percent).                  |
| kpis.top_topics[]           | Most common key-phrases across all entries.                           |
| details[].score             | Normalised sentiment polarity (VADER / transformer blend).            |
| details[].emotion           | First-level emotion tag (e.g., frustration, joy, gratitude, request). |
| details[].key_topics[]      | Phrases auto-extracted from that entry only.                          |

---

### Under the hood

* Text normalisation ‚Üí emoji‚Üíword, lower-case, URL stripping.

* Sentiment model ‚Üí ensemble (VADER + RoBERTa) for polarity score.

* Emotion classifier ‚Üí lightweight transformer fine-tuned on GoEmotions.

* Topic extraction ‚Üí KeyBERT + POS filters + k-means clustering.

* Roll-up ‚Üí period aggregation and summary generation.

Everything is stateless; resend same entries with a different timeframe for a new view (e.g., daily cut).

---

### Best-practice tips

| **Tip**                     | **Why it matters**                                                |
| --------------------------- | ----------------------------------------------------------------- |
| Batch at least \~30 entries | Topic clustering stabilises; small sets may be noisy.             |
| Retain raw emojis           | Boosts emotion detection (üò°, üòç, üëç).                           |
| Feed support tags into text | E.g., `#login #bug` ‚Äì appears as key topics.                      |
| Stream daily, recap weekly  | Daily alerts (`timeframe=daily`); weekly slices for exec reports. |

---

**TL;DR** ‚Äì Point `/api/sentiment_report` at your feedback fire-hose to auto-grade each verbatim, roll it into easy-to-read KPIs, and instantly learn which themes shout the loudest.

---

