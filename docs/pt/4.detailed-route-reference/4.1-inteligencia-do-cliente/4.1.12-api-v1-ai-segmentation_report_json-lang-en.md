# 4.1.12 /api/v1/ai/segmentation_report_json?lang=en
+> Nota: tradu√ß√£o gerada automaticamente a partir do ingl√™s; revise antes de publicar.


End-to-End Narrative Generator

---

### Objetivo

This endpoint takes the raw artefacts from the segmentation engine‚Äîsuch as:

`customers`

`labels`

`dendrogram`

‚Ä¶and returns a fully-synthetic narrative report in JSON format, including:

Executive summary

Cluster-level KPIs

Marketing guidance

Ready-to-paste slide copy

---

### The output is 100% machine-written but reads like a polished analyst deck, ideal for:

Auto-publishing in BI dashboards

Automated PowerPoint generation

Auto-reply reports to stakeholders

---

### Headers `X-Customer-Api-Id`, `X-Secret`


```yml
POST  `https://api-prod.abintel.ai/api/v1/ai/segmentation_report_json?lang=en`
```


| Header              | Value              |
| ------------------- | ------------------ |
| `X-Customer-Api-Id` | `<uuid>`           |
| `X-Secret`          | `<secret>`         |
| `Content-Type`      | `application/json` |

---

### Esquema do Corpo da Requisi√ß√£o

| **Key**      | **Type**      | **Required?**              | **Meaning**                                            | **Typical Source**                                 |
| ------------ | ------------- | -------------------------- | ------------------------------------------------------ | -------------------------------------------------- |
| `customers`  | array<object> | Yes                        | Same feature block used everywhere                     | Materialized view or the last segmentation payload |
| `labels`     | object        | Yes                        | Mapping `customer_id ‚Üí cluster_id`                     | From `/purchasing_segmentation`                    |
| `dendrogram` | object        | Optional (but recommended) | Raw dendrogram including `linkage`, `labels`, `legend` | From `/purchasing_segmentation_dendrogram`         |

üìù If you omit the `dendrogram`, the service still returns a complete report.
However, the dendrogram-specific insights and visual hierarchy analysis sections will be skipped.

---

### Requisi√ß√£o

```json
{"customers": [
    { "id": "C001", "frequency": 28, "amount_spent": 4120.75, "product_types": ["laptop", "mouse", "keyboard", "monitor"] },
    { "id": "C002", "frequency":  5, "amount_spent":  190.40, "product_types": ["tea", "coffee"] },
    { "id": "C003", "frequency": 12, "amount_spent":  845.10, "product_types": ["jeans", "t-shirt", "sneakers"] },
    { "id": "C004", "frequency":  2, "amount_spent":   75.00, "product_types": ["notebook"] },
    { "id": "C005", "frequency": 17, "amount_spent": 1324.55, "product_types": ["smartphone", "earbuds"] },
    { "id": "C006", "frequency":  8, "amount_spent":  510.30, "product_types": ["dog food", "cat food"] },
    { "id": "C007", "frequency": 24, "amount_spent": 2780.90, "product_types": ["smart-tv", "soundbar", "hdmi-cable"] },
    { "id": "C008", "frequency": 10, "amount_spent":  660.00, "product_types": ["yogurt", "milk", "cheese"] },
    { "id": "C009", "frequency":  3, "amount_spent":  120.00, "product_types": ["stationery"] },
    { "id": "C010", "frequency": 15, "amount_spent":  975.65, "product_types": ["beer", "wine", "snacks"] },

    { "id": "C011", "frequency":  7, "amount_spent":  450.25, "product_types": ["books", "pens"] },
    { "id": "C012", "frequency": 25, "amount_spent": 3015.90, "product_types": ["tablet", "stylus", "cover"] },
    { "id": "C013", "frequency":  6, "amount_spent":  210.10, "product_types": ["pasta", "sauce"] },
    { "id": "C014", "frequency": 20, "amount_spent": 1884.00, "product_types": ["fitness-watch"] },
    { "id": "C015", "frequency":  1, "amount_spent":   40.00, "product_types": ["batteries"] },
    { "id": "C016", "frequency": 13, "amount_spent": 1105.35, "product_types": ["printer", "ink"] },
    { "id": "C017", "frequency":  4, "amount_spent":  160.00, "product_types": ["flour", "sugar", "eggs"] },
    { "id": "C018", "frequency": 30, "amount_spent": 4522.60, "product_types": ["gaming-pc", "rgb-mouse", "gaming-chair", "headset"] },
    { "id": "C019", "frequency": 11, "amount_spent":  720.00, "product_types": ["makeup", "skincare"] },
    { "id": "C020", "frequency":  9, "amount_spent":  585.40, "product_types": ["toys", "board-games"] },

    { "id": "C021", "frequency":  2, "amount_spent":   55.00, "product_types": ["candles"] },
    { "id": "C022", "frequency": 18, "amount_spent": 1410.70, "product_types": ["camera", "sd-card"] },
    { "id": "C023", "frequency": 14, "amount_spent":  992.00, "product_types": ["office-chair", "desk-lamp"] },
    { "id": "C024", "frequency":  3, "amount_spent":  135.00, "product_types": ["juice", "cookies"] },
    { "id": "C025", "frequency": 12, "amount_spent":  830.20, "product_types": ["running-shoes", "sports-socks"] },
    { "id": "C026", "frequency": 23, "amount_spent": 2560.00, "product_types": ["fridge", "water-filter"] },
    { "id": "C027", "frequency":  6, "amount_spent":  260.40, "product_types": ["vitamins"] },
    { "id": "C028", "frequency":  5, "amount_spent":  195.99, "product_types": ["wine", "cheese"] },
    { "id": "C029", "frequency": 19, "amount_spent": 1599.95, "product_types": ["e-reader", "ebooks"] },
    { "id": "C030", "frequency": 22, "amount_spent": 2345.00, "product_types": ["washing-machine", "detergent"] },

    { "id": "C031", "frequency":  4, "amount_spent":  175.50, "product_types": ["herbs", "spices"] },
    { "id": "C032", "frequency":  8, "amount_spent":  540.00, "product_types": ["diapers", "baby-wipes", "formula"] },
    { "id": "C033", "frequency": 27, "amount_spent": 3350.80, "product_types": ["console", "controller", "games"] },
    { "id": "C034", "frequency": 10, "amount_spent":  705.35, "product_types": ["sunscreen", "after-sun"] },
    { "id": "C035", "frequency":  3, "amount_spent":  150.00, "product_types": ["frozen-pizza"] },
    { "id": "C036", "frequency": 16, "amount_spent": 1240.60, "product_types": ["tool-set", "drill"] },
    { "id": "C037", "frequency":  9, "amount_spent":  610.10, "product_types": ["organic-vegetables"] },
    { "id": "C038", "frequency": 21, "amount_spent": 2105.00, "product_types": ["air-fryer", "cookbook"] },
    { "id": "C039", "frequency":  7, "amount_spent":  435.75, "product_types": ["flowers", "vase"] },
    { "id": "C040", "frequency": 14, "amount_spent": 1015.90, "product_types": ["winter-jacket", "gloves", "scarf"] }
  ],
 "labels": {
        "C001": 2,
        "C002": 0,
        "C003": 0,
        "C004": 0,
        "C005": 0,
        "C006": 0,
        "C007": 1,
        "C008": 0,
        "C009": 0,
        "C010": 0,
        "C011": 0,
        "C012": 1,
        "C013": 0,
        "C014": 1,
        "C015": 0,
        "C016": 0,
        "C017": 0,
        "C018": 2,
        "C019": 0,
        "C020": 0,
        "C021": 0,
        "C022": 0,
        "C023": 0,
        "C024": 0,
        "C025": 0,
        "C026": 1,
        "C027": 0,
        "C028": 0,
        "C029": 0,
        "C030": 1,
        "C031": 0,
        "C032": 0,
        "C033": 1,
        "C034": 0,
        "C035": 0,
        "C036": 0,
        "C037": 0,
        "C038": 1,
        "C039": 0,
        "C040": 0
    },

   "dendrogram": {
        "linkage_matrix": [
            [
                1.0,
                27.0,
                5.5900115966796875,
                2.0
            ],
            [
                16.0,
                34.0,
                10.246950765959598,
                2.0
            ],
            [
                10.0,
                38.0,
                14.5,
                2.0
            ],
            [
                18.0,
                33.0,
                14.684114387072421,
                2.0
            ],
            [
                2.0,
                24.0,
                14.933482805184708,
                2.0
            ],
            [
                14.0,
                20.0,
                15.033296378372908,
                2.0
            ],
            [
                8.0,
                23.0,
                15.033296378372908,
                2.0
            ],
            [
                9.0,
                22.0,
                16.41102378466232,
                2.0
            ],
            [
                12.0,
                40.0,
                19.554342797373597,
                3.0
            ],
            [
                30.0,
                41.0,
                23.67840084690405,
                3.0
            ],
            [
                19.0,
                36.0,
                24.720185838561353,
                2.0
            ],
            [
                5.0,
                31.0,
                29.71684244831212,
                2.0
            ],
            [
                3.0,
                45.0,
                31.75951301054011,
                3.0
            ],
            [
                39.0,
                47.0,
                37.04603277151646,
                3.0
            ],
            [
                46.0,
                49.0,
                53.204636389447614,
                5.0
            ],
            [
                7.0,
                43.0,
                60.837535989873956,
                3.0
            ],
            [
                26.0,
                48.0,
                75.42189702647553,
                4.0
            ],
            [
                4.0,
                35.0,
                83.95602895187841,
                2.0
            ],
            [
                50.0,
                51.0,
                102.69139093644127,
                4.0
            ],
            [
                15.0,
                53.0,
                135.75478433757996,
                4.0
            ],
            [
                54.0,
                56.0,
                139.4687935795597,
                9.0
            ],
            [
                21.0,
                57.0,
                147.95607449395212,
                3.0
            ],
            [
                42.0,
                58.0,
                193.4435440607144,
                6.0
            ],
            [
                25.0,
                29.0,
                215.00232556881798,
                2.0
            ],
            [
                44.0,
                55.0,
                220.82693991432996,
                5.0
            ],
            [
                13.0,
                37.0,
                221.00452484055614,
                2.0
            ],
            [
                6.0,
                11.0,
                235.00212764994276,
                2.0
            ],
            [
                52.0,
                60.0,
                256.36800922508723,
                12.0
            ],
            [
                28.0,
                61.0,
                336.40545943552,
                4.0
            ],
            [
                0.0,
                17.0,
                401.8550746056813,
                2.0
            ],
            [
                32.0,
                66.0,
                522.3946688588159,
                3.0
            ],
            [
                62.0,
                64.0,
                537.5921954390619,
                11.0
            ],
            [
                63.0,
                65.0,
                647.7163731140352,
                4.0
            ],
            [
                59.0,
                68.0,
                743.4835774228395,
                8.0
            ],
            [
                70.0,
                72.0,
                1528.9174504219059,
                7.0
            ],
            [
                67.0,
                71.0,
                1623.9774150881199,
                23.0
            ],
            [
                73.0,
                75.0,
                2865.3048816814076,
                31.0
            ],
            [
                69.0,
                74.0,
                3076.681261272462,
                9.0
            ],
            [
                76.0,
                77.0,
                8866.563988339083,
                40.0
            ]
        ],
        "columns": [
            "child1",
            "child2",
            "distance",
            "sample_count"
        ],
        "leaf_labels": [
            "C001",
            "C002",
            "C003",
            "C004",
            "C005",
            "C006",
            "C007",
            "C008",
            "C009",
            "C010",
            "C011",
            "C012",
            "C013",
            "C014",
            "C015",
            "C016",
            "C017",
            "C018",
            "C019",
            "C020",
            "C021",
            "C022",
            "C023",
            "C024",
            "C025",
            "C026",
            "C027",
            "C028",
            "C029",
            "C030",
            "C031",
            "C032",
            "C033",
            "C034",
            "C035",
            "C036",
            "C037",
            "C038",
            "C039",
            "C040"
        ],
        "cluster_legend": [
            {
                "cluster_id": 0,
                "n_customers": 31,
                "avg_spend": 591.11,
                "avg_frequency": 8.81,
                "top_categories": "wine, cheese, diapers"
            },
            {
                "cluster_id": 1,
                "n_customers": 7,
                "avg_spend": 2577.37,
                "avg_frequency": 23.14,
                "top_categories": "smart-tv, soundbar, hdmi-cable"
            },
            {
                "cluster_id": 2,
                "n_customers": 2,
                "avg_spend": 4321.68,
                "avg_frequency": 29.0,
                "top_categories": "laptop, mouse, keyboard"
            }
        ]
    }
}
```

---

### What the Service Does Internally

1. Aggregates customer-level data into cluster metrics (`n_customers`, revenue share, TF-IDF categories‚Ä¶).

2. Generates text via a structured NLG pipeline (templating + GPT-4-Turbo fine-tune) in the requested language.

3. Packages everything into a single JSON object ‚Äì each top-level key is a ready-made paragraph or table.

4. Echoes raw payload at the bottom so the entire request/response is self-contained for audit. Latency: ~400 ms for ‚â§ 50 k customers on CPU.

---

### Resposta

```json
{
    "language": "English",
    "generated_on": "2025-05-20T17:47:09",
    "executive_summary": "The segmentation analysis has revealed three distinct customer clusters among the 40 customers, each exhibiting unique buying behaviors, spending patterns, and product preferences. Cluster 0, the largest group with 31 customers, shows moderate spending and lower purchase frequency, with top categories including everyday items like wine, cheese, and diapers. Cluster 1, composed of 7 customers, reflects higher average spending and frequency, with a clear inclination towards home entertainment electronics such as smart TVs, soundbars, and HDMI cables. Meanwhile, Cluster 2, although the smallest with only 2 customers, represents a niche segment focused on premium technology products like laptops, mice, and keyboards. These insights are backed by both the classic cluster legend summary and the dendrogram analysis, which provides granular insights into the hierarchical relationships among the customers based on their purchase behaviors.",
    "cluster_analysis": "The dendrogram and cluster legend provide a thorough breakdown of each cluster, highlighting important metrics such as the average spend and purchase frequency. Cluster 0 has an average spend of approximately 591.11 and purchase frequency of 8.81, indicating a more conservative shopping behavior with emphasis on cost-effective and everyday items. Cluster 1 shows an average spend of about 2577.37 with a frequency of 23.14, suggesting these customers are more engaged, possibly making deliberate and technology-focused investments at a higher price point. Cluster 2, with an average spend of 4321.68 and a purchase frequency of 29, targets power users or tech enthusiasts who demand high-end, performance-oriented products. This segmentation allows for clear targeting and differentiation strategies, ensuring that marketing efforts can be customized based on the customer's spending power and product affinity.",
    "customer_insights": "Each customer segment exhibits distinct characteristics that can be leveraged for targeted communication and engagement. Customers in Cluster 0 are likely to be price-conscious and value-driven, prioritizing affordability and convenience, which aligns with essential or recurring purchases. Cluster 1 customers appear to value enhanced experiences and technological upgrades, demonstrating a willingness to invest in quality home entertainment and electronics. The niche Cluster 2 customers are high spenders with a keen interest in premium technology products, potentially tech-savvy individuals who demand the latest and highest performing gadgets. These insights reveal a layered customer base, where understanding the underlying motivations and purchase patterns is critical in tailoring personalized messaging and offers that meet each segment's unique needs.",
    "marketing_recommendations": "Based on the detailed segmentation, it is recommended that marketing campaigns be highly personalized to address the distinct needs of each cluster. For Cluster 0, promotions should focus on value-for-money, bundling everyday items with loyalty discounts and seasonal offers that emphasize cost savings. Cluster 1 should be targeted with campaigns showcasing cutting-edge technology, product demos, and bundled high-tech entertainment packages alongside opportunities for upgrades and trade-ins. For the high-end Cluster 2, marketing should highlight premium quality, exclusive features, and after-sales support that reaffirms the brand‚Äôs leadership in innovation. Cross-channel promotions and personalized offers based on customer behavior analytics will ensure that messaging resonates effectively with each apportioned customer segment.",
    "channel_strategy": "The channel strategy must be diversified to meet the varied preferences of each customer segment. Digital channels, including targeted social media advertising, email marketing, and search engine marketing, can be utilized to effectively reach both Cluster 1 and Cluster 2 populations who are likely to be more digitally connected and responsive to dynamic content. For Cluster 0, a mix of traditional channels like direct mailers, local promotions, and in-store advertisements can complement digital outreach. Additionally, leveraging data-driven platforms to analyze web behavior and purchase history will enable retargeting efforts that refine messaging across channels. An integrated omni-channel approach, supported by a customer relationship management system that tracks engagement across platforms, is essential to deliver timely, relevant communications that drive both acquisition and retention.",
    "product_cross_sell_ideas": "There exists significant potential for cross-selling across the different customer clusters by identifying complementary products based on current purchasing habits. For instance, customers in Cluster 0 purchasing everyday items could be effectively introduced to bundled packages that include high-margin accessories or value-added services such as subscription models for essential consumables. In Cluster 1, a tech pairing of smart TVs with available streaming devices or enhanced sound systems can drive incremental sales. For Cluster 2, premium accessory upgrades such as ergonomic chairs, advanced peripheral devices, or extended warranties for laptops and high-end gadgets can be promoted. Additionally, targeting customers with complementary lifestyle or utility products based on their prior purchases offers the opportunity for personalized recommendations that add value to the customer experience while increasing average order value.",
    "retention_actions": "Retention efforts should focus on creating cohesive loyalty programs and personalized post-purchase support that continuously reinforces the value derived from ongoing engagement with the brand. For Cluster 0, incentives such as reward points, membership discounts, and exclusive offers on repeat purchases will help reduce churn. Cluster 1 customers can benefit from early access to new releases, invitations to exclusive product launches, and dedicated customer support that emphasizes premium service. For the higher-end Cluster 2, tailored concierge services, loyalty tiers with benefits such as extended warranties or priority support, and invitations to VIP events or tech expos can solidify long-term loyalty. Systematic customer engagement initiatives, including follow-up surveys and proactive feedback loops, are recommended to continuously gauge satisfaction levels and preemptively address concerns before they escalate.",
    "next_steps": "The next steps involve a detailed review of the segmentation findings by the marketing, data science, and product teams to align on targeting strategies and content personalization for each distinct customer cluster. It is recommended to develop pilot campaigns for each segment, monitor performance metrics closely, and adjust strategies based on real-time customer feedback and behavior analytics. Investing in advanced CRM tools to better track multi-channel engagement and integrating these insights with customer lifetime value models will further refine targeting refinements. Additionally, a cross-functional workshop should be organized to translate these insights into actionable marketing tactics, ensuring that product development, customer support, and sales are aligned in executing the tailored strategies efficiently and effectively.",
    "auto_insights": [
        "Cluster 0 has the most customers (31).",
        "Cluster 2 shows the highest average ticket (4,322).",
        "Cluster 0 generates 40.7% of total revenue."
    ],
    "dendrogram_insights": "‚Ä¢ The clusters can be thought of as segments on a continuum from lower to higher spend and frequency, with Cluster‚ÄØ0 at the lower end and Cluster‚ÄØ2 at the higher end.  \n‚ÄÉ‚Äì Cluster 0:  \n‚ÄÉ‚ÄÉ‚Ä¢ 31 customers with the lowest average spend and frequency.  \n‚ÄÉ‚ÄÉ‚Ä¢ Their top purchases mix lifestyle goods (wine, cheese) with commodity items (diapers), implying a diverse but low-intensity purchasing pattern.  \n‚ÄÉ‚ÄÉ‚Ä¢ Synergy Opportunity: There is potential to cross-promote higher-margin or complementary products that are common to other clusters, by leveraging their everyday purchasing habits.  \n‚ÄÉ‚ÄÉ‚Ä¢ Cannibalisation Risk: Minimal if differentiated offers are maintained since their product mix is distinct from technology-focused clusters.  \n‚ÄÉ‚ÄÉ‚Ä¢ Migration Path: With targeted marketing or loyalty programs, some users might be nudged toward premium products offered in Clusters‚ÄØ1 and 2 if they develop a taste for technology or upgrade their lifestyle conveniences.\n\n‚Ä¢ Cluster 1:  \n‚ÄÉ‚Äì 7 customers with moderate average spend and frequency.  \n‚ÄÉ‚Äì Their top categories are tech-related consumer electronics (smart-tv, soundbar, hdmi-cable), which nestles them between general lifestyle and high-end tech buyers.  \n‚ÄÉ‚Äì Synergy",
    "cluster_metrics": [
        {
            "cluster_id": 0,
            "n_customers": 31,
            "avg_spend": 591.11,
            "avg_frequency": 8.81,
            "top_categories": "wine, cheese, diapers",
            "share_revenue_pct": 40.71244292298313
        },
        {
            "cluster_id": 1,
            "n_customers": 7,
            "avg_spend": 2577.37,
            "avg_frequency": 23.14,
            "top_categories": "smart-tv, soundbar, hdmi-cable",
            "share_revenue_pct": 40.084084732597844
        },
        {
            "cluster_id": 2,
            "n_customers": 2,
            "avg_spend": 4321.68,
            "avg_frequency": 29.0,
            "top_categories": "laptop, mouse, keyboard",
            "share_revenue_pct": 19.20347234441903
        }
    ],
    "raw_payload": {
        "customers": [
            {
                "id": "C001",
                "frequency": 28,
                "amount_spent": 4120.75,
                "product_types": [
                    "laptop",
                    "mouse",
                    "keyboard",
                    "monitor"
                ]
            },
            {
                "id": "C002",
                "frequency": 5,
                "amount_spent": 190.4,
                "product_types": [
                    "tea",
                    "coffee"
                ]
            },
            {
                "id": "C003",
                "frequency": 12,
                "amount_spent": 845.1,
                "product_types": [
                    "jeans",
                    "t-shirt",
                    "sneakers"
                ]
            },
            {
                "id": "C004",
                "frequency": 2,
                "amount_spent": 75.0,
                "product_types": [
                    "notebook"
                ]
            },
            {
                "id": "C005",
                "frequency": 17,
                "amount_spent": 1324.55,
                "product_types": [
                    "smartphone",
                    "earbuds"
                ]
            },
            {
                "id": "C006",
                "frequency": 8,
                "amount_spent": 510.3,
                "product_types": [
                    "dog food",
                    "cat food"
                ]
            },
            {
                "id": "C007",
                "frequency": 24,
                "amount_spent": 2780.9,
                "product_types": [
                    "smart-tv",
                    "soundbar",
                    "hdmi-cable"
                ]
            },
            {
                "id": "C008",
                "frequency": 10,
                "amount_spent": 660.0,
                "product_types": [
                    "yogurt",
                    "milk",
                    "cheese"
                ]
            },
            {
                "id": "C009",
                "frequency": 3,
                "amount_spent": 120.0,
                "product_types": [
                    "stationery"
                ]
            },
            {
                "id": "C010",
                "frequency": 15,
                "amount_spent": 975.65,
                "product_types": [
                    "beer",
                    "wine",
                    "snacks"
                ]
            },
            {
                "id": "C011",
                "frequency": 7,
                "amount_spent": 450.25,
                "product_types": [
                    "books",
                    "pens"
                ]
            },
            {
                "id": "C012",
                "frequency": 25,
                "amount_spent": 3015.9,
                "product_types": [
                    "tablet",
                    "stylus",
                    "cover"
                ]
            },
            {
                "id": "C013",
                "frequency": 6,
                "amount_spent": 210.1,
                "product_types": [
                    "pasta",
                    "sauce"
                ]
            },
            {
                "id": "C014",
                "frequency": 20,
                "amount_spent": 1884.0,
                "product_types": [
                    "fitness-watch"
                ]
            },
            {
                "id": "C015",
                "frequency": 1,
                "amount_spent": 40.0,
                "product_types": [
                    "batteries"
                ]
            },
            {
                "id": "C016",
                "frequency": 13,
                "amount_spent": 1105.35,
                "product_types": [
                    "printer",
                    "ink"
                ]
            },
            {
                "id": "C017",
                "frequency": 4,
                "amount_spent": 160.0,
                "product_types": [
                    "flour",
                    "sugar",
                    "eggs"
                ]
            },
            {
                "id": "C018",
                "frequency": 30,
                "amount_spent": 4522.6,
                "product_types": [
                    "gaming-pc",
                    "rgb-mouse",
                    "gaming-chair",
                    "headset"
                ]
            },
            {
                "id": "C019",
                "frequency": 11,
                "amount_spent": 720.0,
                "product_types": [
                    "makeup",
                    "skincare"
                ]
            },
            {
                "id": "C020",
                "frequency": 9,
                "amount_spent": 585.4,
                "product_types": [
                    "toys",
                    "board-games"
                ]
            },
            {
                "id": "C021",
                "frequency": 2,
                "amount_spent": 55.0,
                "product_types": [
                    "candles"
                ]
            },
            {
                "id": "C022",
                "frequency": 18,
                "amount_spent": 1410.7,
                "product_types": [
                    "camera",
                    "sd-card"
                ]
            },
            {
                "id": "C023",
                "frequency": 14,
                "amount_spent": 992.0,
                "product_types": [
                    "office-chair",
                    "desk-lamp"
                ]
            },
            {
                "id": "C024",
                "frequency": 3,
                "amount_spent": 135.0,
                "product_types": [
                    "juice",
                    "cookies"
                ]
            },
            {
                "id": "C025",
                "frequency": 12,
                "amount_spent": 830.2,
                "product_types": [
                    "running-shoes",
                    "sports-socks"
                ]
            },
            {
                "id": "C026",
                "frequency": 23,
                "amount_spent": 2560.0,
                "product_types": [
                    "fridge",
                    "water-filter"
                ]
            },
            {
                "id": "C027",
                "frequency": 6,
                "amount_spent": 260.4,
                "product_types": [
                    "vitamins"
                ]
            },
            {
                "id": "C028",
                "frequency": 5,
                "amount_spent": 195.99,
                "product_types": [
                    "wine",
                    "cheese"
                ]
            },
            {
                "id": "C029",
                "frequency": 19,
                "amount_spent": 1599.95,
                "product_types": [
                    "e-reader",
                    "ebooks"
                ]
            },
            {
                "id": "C030",
                "frequency": 22,
                "amount_spent": 2345.0,
                "product_types": [
                    "washing-machine",
                    "detergent"
                ]
            },
            {
                "id": "C031",
                "frequency": 4,
                "amount_spent": 175.5,
                "product_types": [
                    "herbs",
                    "spices"
                ]
            },
            {
                "id": "C032",
                "frequency": 8,
                "amount_spent": 540.0,
                "product_types": [
                    "diapers",
                    "baby-wipes",
                    "formula"
                ]
            },
            {
                "id": "C033",
                "frequency": 27,
                "amount_spent": 3350.8,
                "product_types": [
                    "console",
                    "controller",
                    "games"
                ]
            },
            {
                "id": "C034",
                "frequency": 10,
                "amount_spent": 705.35,
                "product_types": [
                    "sunscreen",
                    "after-sun"
                ]
            },
            {
                "id": "C035",
                "frequency": 3,
                "amount_spent": 150.0,
                "product_types": [
                    "frozen-pizza"
                ]
            },
            {
                "id": "C036",
                "frequency": 16,
                "amount_spent": 1240.6,
                "product_types": [
                    "tool-set",
                    "drill"
                ]
            },
            {
                "id": "C037",
                "frequency": 9,
                "amount_spent": 610.1,
                "product_types": [
                    "organic-vegetables"
                ]
            },
            {
                "id": "C038",
                "frequency": 21,
                "amount_spent": 2105.0,
                "product_types": [
                    "air-fryer",
                    "cookbook"
                ]
            },
            {
                "id": "C039",
                "frequency": 7,
                "amount_spent": 435.75,
                "product_types": [
                    "flowers",
                    "vase"
                ]
            },
            {
                "id": "C040",
                "frequency": 14,
                "amount_spent": 1015.9,
                "product_types": [
                    "winter-jacket",
                    "gloves",
                    "scarf"
                ]
            }
        ],
        "labels": {
            "C001": 2,
            "C002": 0,
            "C003": 0,
            "C004": 0,
            "C005": 0,
            "C006": 0,
            "C007": 1,
            "C008": 0,
            "C009": 0,
            "C010": 0,
            "C011": 0,
            "C012": 1,
            "C013": 0,
            "C014": 1,
            "C015": 0,
            "C016": 0,
            "C017": 0,
            "C018": 2,
            "C019": 0,
            "C020": 0,
            "C021": 0,
            "C022": 0,
            "C023": 0,
            "C024": 0,
            "C025": 0,
            "C026": 1,
            "C027": 0,
            "C028": 0,
            "C029": 0,
            "C030": 1,
            "C031": 0,
            "C032": 0,
            "C033": 1,
            "C034": 0,
            "C035": 0,
            "C036": 0,
            "C037": 0,
            "C038": 1,
            "C039": 0,
            "C040": 0
        },
        "dendrogram": {
            "linkage_matrix": [
                [
                    1.0,
                    27.0,
                    5.5900115966796875,
                    2.0
                ],
                [
                    16.0,
                    34.0,
                    10.246950765959598,
                    2.0
                ],
                [
                    10.0,
                    38.0,
                    14.5,
                    2.0
                ],
                [
                    18.0,
                    33.0,
                    14.684114387072421,
                    2.0
                ],
                [
                    2.0,
                    24.0,
                    14.933482805184708,
                    2.0
                ],
                [
                    14.0,
                    20.0,
                    15.033296378372908,
                    2.0
                ],
                [
                    8.0,
                    23.0,
                    15.033296378372908,
                    2.0
                ],
                [
                    9.0,
                    22.0,
                    16.41102378466232,
                    2.0
                ],
                [
                    12.0,
                    40.0,
                    19.554342797373597,
                    3.0
                ],
                [
                    30.0,
                    41.0,
                    23.67840084690405,
                    3.0
                ],
                [
                    19.0,
                    36.0,
                    24.720185838561353,
                    2.0
                ],
                [
                    5.0,
                    31.0,
                    29.71684244831212,
                    2.0
                ],
                [
                    3.0,
                    45.0,
                    31.75951301054011,
                    3.0
                ],
                [
                    39.0,
                    47.0,
                    37.04603277151646,
                    3.0
                ],
                [
                    46.0,
                    49.0,
                    53.204636389447614,
                    5.0
                ],
                [
                    7.0,
                    43.0,
                    60.837535989873956,
                    3.0
                ],
                [
                    26.0,
                    48.0,
                    75.42189702647553,
                    4.0
                ],
                [
                    4.0,
                    35.0,
                    83.95602895187841,
                    2.0
                ],
                [
                    50.0,
                    51.0,
                    102.69139093644127,
                    4.0
                ],
                [
                    15.0,
                    53.0,
                    135.75478433757996,
                    4.0
                ],
                [
                    54.0,
                    56.0,
                    139.4687935795597,
                    9.0
                ],
                [
                    21.0,
                    57.0,
                    147.95607449395212,
                    3.0
                ],
                [
                    42.0,
                    58.0,
                    193.4435440607144,
                    6.0
                ],
                [
                    25.0,
                    29.0,
                    215.00232556881798,
                    2.0
                ],
                [
                    44.0,
                    55.0,
                    220.82693991432996,
                    5.0
                ],
                [
                    13.0,
                    37.0,
                    221.00452484055614,
                    2.0
                ],
                [
                    6.0,
                    11.0,
                    235.00212764994276,
                    2.0
                ],
                [
                    52.0,
                    60.0,
                    256.36800922508723,
                    12.0
                ],
                [
                    28.0,
                    61.0,
                    336.40545943552,
                    4.0
                ],
                [
                    0.0,
                    17.0,
                    401.8550746056813,
                    2.0
                ],
                [
                    32.0,
                    66.0,
                    522.3946688588159,
                    3.0
                ],
                [
                    62.0,
                    64.0,
                    537.5921954390619,
                    11.0
                ],
                [
                    63.0,
                    65.0,
                    647.7163731140352,
                    4.0
                ],
                [
                    59.0,
                    68.0,
                    743.4835774228395,
                    8.0
                ],
                [
                    70.0,
                    72.0,
                    1528.9174504219059,
                    7.0
                ],
                [
                    67.0,
                    71.0,
                    1623.9774150881199,
                    23.0
                ],
                [
                    73.0,
                    75.0,
                    2865.3048816814076,
                    31.0
                ],
                [
                    69.0,
                    74.0,
                    3076.681261272462,
                    9.0
                ],
                [
                    76.0,
                    77.0,
                    8866.563988339083,
                    40.0
                ]
            ],
            "columns": [
                "child1",
                "child2",
                "distance",
                "sample_count"
            ],
            "leaf_labels": [
                "C001",
                "C002",
                "C003",
                "C004",
                "C005",
                "C006",
                "C007",
                "C008",
                "C009",
                "C010",
                "C011",
                "C012",
                "C013",
                "C014",
                "C015",
                "C016",
                "C017",
                "C018",
                "C019",
                "C020",
                "C021",
                "C022",
                "C023",
                "C024",
                "C025",
                "C026",
                "C027",
                "C028",
                "C029",
                "C030",
                "C031",
                "C032",
                "C033",
                "C034",
                "C035",
                "C036",
                "C037",
                "C038",
                "C039",
                "C040"
            ],
            "cluster_legend": [
                {
                    "cluster_id": 0,
                    "n_customers": 31,
                    "avg_spend": 591.11,
                    "avg_frequency": 8.81,
                    "top_categories": "wine, cheese, diapers"
                },
                {
                    "cluster_id": 1,
                    "n_customers": 7,
                    "avg_spend": 2577.37,
                    "avg_frequency": 23.14,
                    "top_categories": "smart-tv, soundbar, hdmi-cable"
                },
                {
                    "cluster_id": 2,
                    "n_customers": 2,
                    "avg_spend": 4321.68,
                    "avg_frequency": 29.0,
                    "top_categories": "laptop, mouse, keyboard"
                }
            ]
        }
    }
}
```

---

### Response Object ‚Äì Field-by-Field Guide

| **Top-Level Key**           | **Type**       | **Content**                                                           | **How to Use**                   |
| --------------------------- | -------------- | --------------------------------------------------------------------- | -------------------------------- |
| `language`                  | string         | ‚ÄúEnglish‚Äù, ‚ÄúEspa√±ol‚Äù, ‚ÄúPortugu√™s‚Äù                                     | Confirms NLG locale              |
| `generated_on`              | ISO timestamp  | Report creation time (UTC)                                            | Versioning / caching             |
| `executive_summary`         | string         | 250‚Äì350 word board-level synopsis                                     | Paste directly into slide 1      |
| `cluster_analysis`          | string         | Deeper numeric comparison of clusters                                 | Analyst commentary               |
| `customer_insights`         | string         | Psychographic / behavioral interpretation                             | Brief for CRM & CX               |
| `marketing_recommendations` | string         | Channel / offer guidance                                              | Feed into campaign briefs        |
| `channel_strategy`          | string         | Omnichannel plan aligned to clusters                                  | Share with media agency          |
| `product_cross_sell_ideas`  | string         | Bundle & upsell suggestions                                           | Merchandise roadmap              |
| `retention_actions`         | string         | Loyalty & churn mitigation tactics                                    | CS & Loyalty teams               |
| `next_steps`                | string         | Action plan & governance                                              | Sprint planning                  |
| `auto_insights[]`           | array<string>  | Auto-mined data facts (e.g. ‚ÄúCluster 0 has 40% of revenue‚Äù)           | Tooltip nuggets in BI dashboards |
| `dendrogram_insights`       | string \| null | Hierarchy commentary (only if dendrogram provided)                    | Present with dendrogram visual   |
| `cluster_metrics[]`         | array<object>  | KPI table (ID, size, spend, frequency, top categories, revenue share) | Load into BI dashboards          |
| `raw_payload`               | object         | Echo of your original request (secrets redacted)                      | Use for audit, reproducibility   |

---

### Commercial Value

| **Stakeholder**    | **Pain Solved**                                  | **How This Report Helps**                                        |
| ------------------ | ------------------------------------------------ | ---------------------------------------------------------------- |
| CMO / VP Marketing | Needs quick view of which segments drive revenue | Reads `executive_summary` + `marketing_recommendations` in 3 min |
| Growth Manager     | Lacks campaign copy ideas                        | Uses `product_cross_sell_ideas` directly                         |
| Merchandising Lead | Wants data-backed bundle recommendations         | Refers to `cluster category affinities`                          |
| Data-Ops           | Struggles with manual slide creation             | Automates with `/json ‚Üí Lucid + PPTX template`                   |

---

### Integration Blueprint

Nightly ETL ‚Üí
  /purchasing_segmentation ‚Üí
  /purchasing_segmentation_dendrogram ‚Üí
  /segmentation_report_json?lang=en ‚Üí
  Save JSON to S3 / push sections to:
    ‚Ä¢ Notion wiki
    ‚Ä¢ Tableau dashboard (via Web Data Connector)
    ‚Ä¢ Slack #marketing-daily (via webhook)

---

### Minimal Python Example

```Python

import requests, json, boto3, datetime as dt

payload = { "customers": cust, "labels": labels, "dendrogram": dendro }

r = requests.post(
    "https://api.abintel.ai/api/segmentation_report_json?lang=en",
    headers={"X-Customer-Api-Id": ID, "X-Secret": SECRET},
    json=payload, timeout=60
)

report = r.json()

s3.put_object(
    Bucket="reports",
    Key=f"seg_{dt.date.today()}.json",
    Body=json.dumps(report).encode()
)
```

---

### Tips & Best Practices

Send the full dendrogram ‚Üí unlocks `dendrogram_insights` your execs will love

Localise once, reuse ‚Üí same payload, change `lang=pt` or `lang=es`

Version pinning ‚Üí store `generated_on`, regenerate only if model or payload changes

Custom voice ‚Üí Enterprise tier supports tone-of-voice fine-tuning (contact support)

GDPR compliance ‚Üí hash `customer_id` before sharing externally

---

### FAQ

| **Question**                  | **Answer**                                                                                   |
| ----------------------------- | -------------------------------------------------------------------------------------------- |
| Can I change insight lengths? | Roadmap param: `depth=brief`                                                                 |
| Why repeat the raw payload?   | For self-contained audit trails. Strip before sharing if payload size matters.               |
| We need a PDF                 | Use `/segmentation_report_pdf` (same payload) or feed JSON into your template engine         |
| Does it support Chinese?      | Chinese/Japanese support is planned for 2026. Meanwhile, use `/translate_document` endpoint. |

---

### Pr√≥ximo Passo

Wire this endpoint into your marketing analytics CI/CD.
Every morning, wake up to an auto-written segmentation brief, in the right language, ready to ship.

---

