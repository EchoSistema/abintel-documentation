# 4.1.14 /api/v1/ai/nps

---

### Purpose

Real-Time Net-Promoter-Score Calculator
Compute the overall NPS for a survey batch and, optionally, slice the score by any categorical field (store, region, plan, agent, channel, etc.).
The service returns ready-made percentages plus a quick-read interpretation band so non-analysts can understand at a glance.

---

### Headers `X-Customer-Api-Id`, `X-Secret`

```yaml
POST  https://api-prod.abintel.ai/api/v1/ai/nps
Headers
  X-Customer-Api-Id: <uuid>
  X-Secret:          <secret>
  Content-Type:      application/json
```

---

### Request Body Schema

| **JSON Key**    | **Type / Range** | **Required?** | **Business Meaning**           | **Notes / Derivation**               |
| --------------- | ---------------- | ------------- | ------------------------------ | ------------------------------------ |
| `group_by`      | string           | optional      | Column to break out NPS by     | Leave empty to skip grouping         |
| `data[]`        | array<object>    | yes           | List of NPS responses          | Max 50,000 rows / 5 MB               |
| ↳ `customer_id` | string           | yes           | Respondent identifier          | For traceability                     |
| ↳ `question`    | string           | optional      | Survey question text           | Echoed back untouched                |
| ↳ `answer`      | int (0–10)       | yes           | Classic NPS scale              | Out-of-range returns HTTP 400        |
| ↳ `group`       | any              | conditional   | Value of the `group_by` column | Can be anything: store, region, etc. |
| ↳ `date`        | ISO-8601         | optional      | Response date                  | Useful for dashboards                |

---

### Request Example

```json
{
  "group_by": "group",
  "data": [
    {
      "customer_id": "C-0001",
      "question": "How likely are you to recommend our app?",
      "answer": 9,
      "group": "Store-A",
      "date": "2025-04-28"
    },
    {
      "customer_id": "C-0002",
      "answer": 4,
      "group": "Store-A",
      "date": "2025-04-28"
    },
    {
      "customer_id": "C-0003",
      "answer": 10,
      "group": "Store-B",
      "date": "2025-04-28"
    }
  ]
}
```

---

### How the Service Calculates NPS

* `Promoters` = answers 9–10

* `Passives` = answers 7–8

* `Detractors` = answers 0–6

`NPS = (%Promoters − %Detractors) × 100`
Values are rounded to two decimals.

---

### Interpretation Bands

| **NPS Score** | **Label**                   |
| ------------- | --------------------------- |
| ≥ 70          | World-class loyalty         |
| 50 – 69       | Excellent                   |
| 30 – 49       | Good                        |
| 0 – 29        | Fair – room for improvement |
| −100 – −1     | Critical warning            |

Customizable in enterprise plan

---

### Response Example

```json
{
  "overall": {
    "nps": 33.33,
    "promoters_pct": 66.67,
    "passives_pct": 0.0,
    "detractors_pct": 33.33,
    "responses": 3,
    "interpretation": "Fair – room for improvement"
  },
  "by_group": [
    {
      "nps": 0.0,
      "promoters_pct": 50.0,
      "passives_pct": 0.0,
      "detractors_pct": 50.0,
      "responses": 2,
      "group": "Store-A",
      "interpretation": "Fair – room for improvement"
    },
    {
      "nps": 100.0,
      "promoters_pct": 100.0,
      "passives_pct": 0.0,
      "detractors_pct": 0.0,
      "responses": 1,
      "group": "Store-B",
      "interpretation": "World-class loyalty"
    }
  ]
}
```

---

### Field Guide

| **Path**                 | **Type** | **Meaning**               | **Dashboard Use**       |
| ------------------------ | -------- | ------------------------- | ----------------------- |
| `overall.nps`            | float    | Global NPS                | Trend analysis          |
| `overall.promoters_pct`  | float %  | Promoter share            | Target ≥ 60%            |
| `overall.passives_pct`   | float %  | Passive share             | Monitor shifts          |
| `overall.detractors_pct` | float %  | Detractor share           | Trigger alerts if >20%  |
| `by_group[]`             | array    | Per-group metrics         | Heat-maps, slice & dice |
| `interpretation`         | string   | Interpretation band label | Copy to Slack, emails   |

---

### Commercial Playbooks

| **Scenario**               | **Action**                                                       | **Outcome**                         |
| -------------------------- | ---------------------------------------------------------------- | ----------------------------------- |
| Store-B pops 100 NPS       | Use as benchmark in testimonials & ads                           | +12% conversion                     |
| Store-A stuck at 0 NPS     | Deep-dive into CSAT logs, fulfilment issues                      | Find root causes (e.g., stock-outs) |
| Overall slips from 45 → 30 | Fire CSAT survey to Passives, route Detractors to retention team | +8pp recovery within 2 weeks        |

---

### Integration Best Practices

1. Collect responses via email, WhatsApp, app, kiosk, etc.

2. ETL raw data into staging table

3. Call /api/nps hourly and store the snapshot

4. Visualise with heat-maps and trend lines

5. Alert on NPS drops across bands

---

### Python Cron Job Example

```Python
payload = build_payload_from_sql(last_hour())
r = requests.post(
    "https://api.abintel.ai/api/nps",
    headers={"X-Customer-Api-Id": ID, "X-Secret": SECRET},
    json=payload,
    timeout=15
)
db.insert("nps_snapshot", r.json())
```

---

### FAQ

| **Question**               | **Answer**                                                         |
| -------------------------- | ------------------------------------------------------------------ |
| Can I group by two fields? | Not yet. Use multiple calls. Multi-dim grouping in roadmap (v1.9). |
| What if answer is 11?      | Will return HTTP 400. Clean data before sending.                   |
| Max number of groups?      | Up to 1,000 unique group values per call.                          |
| Does it store my data?     | No. Stateless; payload is discarded after \~2 minutes.             |

---

### Next Step
Automate NPS snapshots hourly, trigger alerts on Detractor spikes, and share grouped insights with frontline teams to drive continuous improvement in customer experience (CX).

---

